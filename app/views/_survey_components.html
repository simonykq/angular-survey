<accordion close-others="true">
    <accordion-group heading="{{survey.title}}" id="survey_{{$index}}" ng-repeat="survey in surveys">
      <div class="panel-body" lazy-load="#survey_{{$index}}" >
        <span >{{survey.description}}</span>
        <br />
        <br />
        <form name="surveyForm" class="survey-form" ng-init="result = {}" novalidate>
          <accordion close-others="true">
            <accordion-group heading="Question {{$index + 1}}: {{field.question}}" ng-repeat="field in survey.fields track by $index">
              <div class="panel-body" ng-init="key = 'field_' + $index" >
                <survey-input field="field" binding="result" key="{{key}}"></survey-input>
                <span ng-if="surveyForm[key].$dirty" ng-messages="surveyForm[key].$error">
                  <span class="error-text" ng-message="required">This field is required</span>
                  <span class="error-text" ng-message="number">This is not a number</span>
                  <span class="error-text" ng-message="date">This is not a date</span>
                  <span class="error-text" ng-message="url">This is not a valid url</span>
                  <span class="error-text" ng-message="email">This is not a valid email</span>
                  <span class="error-text" ng-message="maxlength">Must be no more than {{ field.maxlength }} characters</span>
                  <span class="error-text" ng-message="minlength">Must be at least {{ field.minlength }} characters</span>
                  <span class="error-text" ng-message="maxdate">Must before date {{ field.maxdate }}</span>
                  <span class="error-text" ng-message="mindate">Must after date {{ field.mindate }}</span>
                  <span class="error-text" ng-message="max">Must be less than {{ field.max }}</span>
                  <span class="error-text" ng-message="min">Must be greater than {{ field.min }}</span>
                </span>
              </div>
            </accordion-group>
          </accordion>
          <button type="submit" class="btn btn-primary" ng-click="submitForm(surveyForm, survey, result)" >Submit</button>
          <button class="btn btn-danger" ng-click="clearForm(surveyForm, result)" >Clear</button>
        </form>
      </div>
    </accordion-group>
</accordion>
