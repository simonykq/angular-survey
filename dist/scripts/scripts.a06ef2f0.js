"use strict";function datePickerController(a){a.isOpen=!1,a.open=function(b){b.preventDefault(),b.stopPropagation(),a.isOpen=!a.isOpen}}angular.module("surveyApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch","checklist-model","ui.bootstrap","ui.bootstrap.datetimepicker"]).config(["$routeProvider","$locationProvider","$controllerProvider",function(a,b,c){c.allowGlobals(),b.html5Mode(!0),a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/new",{templateUrl:"views/new.html",controller:"NewCtrl"}).otherwise({redirectTo:"/"})}]);var TYPES=["text","number","email","url","tel","color","range","textarea","select","multi-select","radio","checkbox","datetime","date","time","month","week","day"];angular.module("surveyApp").value("inputTypes",TYPES),angular.module("surveyApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("surveyApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("surveyApp").controller("AppCtrl",["$scope",function(a){a.surveys=[]}]),angular.module("surveyApp").controller("NewCtrl",["$scope","$location",function(a,b){function c(b){b?(b.title="",b.description="",b.fields=[]):a.data={title:"",description:"",fields:[]}}function d(b){b&&a.$parent.surveys.push(angular.copy(b))}function e(a){for(var b in a){var c=a[b];"$"!=b[0]&&(c.$setDirty(),c.hasOwnProperty("$$parentForm")&&e(c))}}c(),a.submitForm=function(a,f){a.$valid?(d(f),c(f),a.$setPristine(),b.path("/")):(a.$setDirty(),e(a))},a.clearForm=function(a,b){a.$dirty&&(a.$setPristine(),c(b))},a.addField=function(a){var b={question:"",type:""};a.push(b)},a.copyField=function(b){var c={question:b.question,type:b.type};a.data.fields.push(c)},a.deleteField=function(b){var c=a.data.fields.indexOf(b);-1!==c&&a.data.fields.splice(c,1)},a.hasOption=function(a){var b=["select","multi-select","radio","checkbox"];return-1!==b.indexOf(a)}}]),angular.module("surveyApp").directive("surveyComponents",function(){return{templateUrl:"views/_survey_components.html",restrict:"E",controller:["$scope",function(a){function b(a){for(var b in a)a[b]=null}function c(a){for(var b in a){var c=a[b];"$"!=b[0]&&c.$pristine&&c.$setDirty()}}a.submitForm=function(a,d,e){a.$valid?(b(e),a.$setPristine(),alert("Submited!")):(a.$setDirty(),c(a))},a.clearForm=function(a,c){a.$dirty&&(b(c),a.$setPristine())}}],scope:{surveys:"=components"}}}),angular.module("surveyApp").directive("surveyField",function(){return{templateUrl:"/views/_survey_field.html",transclude:!0,restrict:"E",scope:{field:"=",count:"@",copy:"&","delete":"&"},controllerAs:"ctrl",controller:["$scope","inputTypes",function(a,b){this.field=a.field,this.inputTypes=b,this.copy=a.copy(),this["delete"]=a["delete"](),this.isValidable=function(a){return this.isRequirable(a)||this.isRequirable(a)||this.isNumerable(a)||this.isDatable(a)},this.isRequirable=function(a){return-1===["checkbox",""].indexOf(a)},this.isRangable=function(a){return-1!==["text","email","url","tel","textarea"].indexOf(a)},this.isNumerable=function(a){return-1!==["number","range"].indexOf(a)},this.isDatable=function(a){return"date"===a},this.cleanUp=function(a,b){a&&delete this.field[b]},this.isFormDirty=function(b,c){var d;return"field"===b?(d="nestedField_"+a.count,a[d]&&a[d][c]?a[d][c].$dirty:!1):(d="nestedValidation_"+a.count,a[d]&&a[d][c]?a[d][c].$dirty:!1)},this.formError=function(b,c){var d;return"field"===b?(d="nestedField_"+a.count,a[d]&&a[d][c]?a[d][c].$error:null):(d="nestedValidation_"+a.count,a[d]&&a[d][c]?a[d][c].$error:null)}}]}}),angular.module("surveyApp").directive("surveyFieldOptions",function(){return{templateUrl:"/views/_survey_field_options.html",restrict:"E",require:"^^surveyField",scope:{},link:{pre:function(a,b,c,d){a.field=d.field,a.newOption={text:""},a.field.options=a.field.options||[]},post:function(a){a.addOption=function(b){var c=b.text;c&&""!==c&&"undefined"!=typeof c&&(a.field.options.push({text:c}),b.text="")},a.deleteOption=function(b){var c=a.field.options.indexOf(b);-1!==c&&a.field.options.splice(c,1)},a.$on("$destroy",function(){delete a.field.options})}}}}),angular.module("surveyApp").directive("surveyInput",["$compile","$parse",function(a,b){return{restrict:"E",replace:!0,scope:{field:"=?",result:"=?binding",key:"@"},templateUrl:"views/_survey_inputs.html",controller:["$scope",function(a){try{if(!a.field)throw new Error("Field model not found on current scope!");var c=a.field,d=c.type;if("month"===d&&(c.options=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),"week"===d&&(c.options=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]),"day"===d&&(c.options=["Sun","Mon","Tue","Wed","Thur","Fri","Sat"]),a.answer={content:null},!a.result||!a.key)throw new Error("Can not data bind result of input to the form. Check field or key attributes on this directive!");var e=b("result."+a.key),f=e.assign;a.$watch("answer.content",function(b){b&&f(a,b)}),a.$watch(e,function(b){a.answer={content:b}}),a.$on("destroy",function(){delete a.result[a.key]})}catch(g){console.error(g.name),console.error(g.message)}}]}}]),angular.module("surveyApp").directive("lazyLoad",function(){return{restrict:"AC",transclude:!0,compile:function(a){return a.html('<button class="btn btn-lg btn-warning text-center" style="display: block; margin: auto;"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Loading...</button>'),function(a,b,c,d,e){var f=c.lazyLoad,g=!1;$("body").on("click",f,function(){g||setTimeout(function(){e(function(a){b.empty(),b.html(a)})},500),g=!0})}}}}),angular.module("surveyApp").directive("waiting",function(){return{restrict:"AC",priority:1e3,transclude:"element",link:function(a,b,c,d,e){var f=a.$eval(c.waiting);if("number"!=typeof f)throw new Error("Not a number");for(var g=+new Date;+new Date-g<1e3*f;);e(function(a){b.replaceWith(a)})}}}),angular.module("surveyApp").directive("surveyDatePicker",["$compile","$filter","$parse",function(a,b){return{templateUrl:"views/_survey_date_picker.html",restrict:"E",scope:{key:"@",format:"@",options:"="},require:"?ngModel",controller:["$scope","$element","$position",function(a,b,c){a.isOpen=!1,a.open=function(b){b.preventDefault(),b.stopPropagation(),a.isOpen=!a.isOpen},a.$watch("isOpen",function(e){var f=b.next();e?(a.position=c.position(b),a.position.top=a.position.top+b.prop("offsetHeight"),f.bind("click",d)):f.unbind("click",d)});var d=function(b){b.preventDefault(),a.$apply(function(){a.isOpen=!1})}}],link:function(c,d,e,f){function g(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}if(f){var h=f,i=c.format||"shortDate";c.$watch("dateValue",function(a,b){a!==b&&(h.$setViewValue(a),h.$render())}),d.find("input").keyup(function(a){a.preventDefault();var b=$(this);c.$apply(function(){h.$setViewValue(b.val()),h.$setDirty()})}),h.$render=function(){var a=h.$viewValue,c=b("date")(a,i);d.find("input").val(c)};var j=function(a){var b=new Date(a);return isNaN(b.getTime())&&a&&""!==a?void h.$setValidity("date",!1):(h.$setValidity("date",!0),a)};h.$parsers.push(j),h.$formatters.unshift(j),e.$observe("format",function(a){i=a||"shortDate",h.$render()});var k=angular.element('<div id="calendar-popup" datepicker-popup-wrap><div datepicker></div></div>'),l=angular.element(k.children()[0]);k.attr({"ng-model":"dateValue"}),angular.forEach(c.options,function(a,b){l.attr(g(b),a)});var m=a(k)(c);k.remove(),d.after(m),c.$on("$destroy",function(){m.remove()})}}}}]),angular.module("surveyApp").directive("testing",function(){return{transclude:!0,restrict:"E",link:{pre:function(a,b){b.html("<h2>Pre link</h2>")},post:function(a,b){b.html("<h2>Post link</h2>")}}}}),angular.module("surveyApp").directive("log",function(){return{controller:["$scope","$element","$attrs","$transclude",function(a,b,c){console.log(c.log+" (controller)")}],compile:function(a,b){return console.log(b.log+" (compile)"),{pre:function(a,b,c){console.log(c.log+" (pre-link)")},post:function(a,b,c){console.log(c.log+" (post-link)")}}}}}),angular.module("surveyApp").directive("dateMax",function(){return{restrict:"A",require:["?ngModel"],link:function(a,b,c,d){if(d[0]){var e=a.$eval(c.dateMax);if(e){var f=d[0];f.$validators.maxdate=function(a){var b=e,c=new Date(b),d=new Date(a);return+c>+d?!0:!1},c.$observe("dateMax",function(){f.$validate()})}}}}}),angular.module("surveyApp").directive("dateMin",function(){return{restrict:"A",require:["?ngModel"],link:function(a,b,c,d){if(d[0]){var e=a.$eval(c.dateMin);if(e){var f=d[0];f.$validators.mindate=function(a){var b=e,c=new Date(b),d=new Date(a);return+d>+c?!0:!1},c.$observe("dateMin",function(){f.$validate()})}}}}});